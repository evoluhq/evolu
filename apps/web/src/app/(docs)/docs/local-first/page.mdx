export const metadata = {
  title: "Get started with local-first",
};

# Get started with local-first

This guide will get you all set up and ready to use Evolu.

<PlatformSelector />

<Note>
  Requirements: `TypeScript 5.7` or later with the `strict` and
  `exactOptionalPropertyTypes` flags enabled in `tsconfig.json` file.
</Note>

## Installation

Evolu offers SDKs for a variety of frameworks, including React, Svelte, React Native, Expo, and others. Below, you can see how to install the SDKs for each framework.

<SinglePlatformCodeGroup>

```bash {{ title: 'React' }}
npm install @evolu/common @evolu/react @evolu/react-web
```

```bash {{ title: 'React Native' }}
npm install @evolu/common @evolu/react @evolu/react-native \
  @op-engineering/op-sqlite react-native-quick-crypto
```

```bash {{ title: 'Expo' }}
npm install @evolu/common @evolu/react @evolu/react-native \
  expo-sqlite react-native-quick-crypto
```

```bash {{ title: 'Svelte' }}
npm install @evolu/common @evolu/web @evolu/svelte
```

```bash {{ title: 'Vue' }}
npm install @evolu/common @evolu/web @evolu/vue
```

```bash {{ title: 'Vanilla JS' }}
npm install @evolu/common @evolu/web
```

</SinglePlatformCodeGroup>

<ConditionalPlatformAlert platform={["Expo"]} type="warning">
  **Expo Go is not supported** as it requires native dependencies
  (`react-native-quick-crypto`). Use `expo-sqlite` for standard performance or
  `expo-op-sqlite` for better performance.
</ConditionalPlatformAlert>

<ConditionalPlatformAlert platform={["Expo", "React Native"]} type="info">
  Make sure to follow the [react-native-quick-crypto setup
  instructions](https://github.com/margelo/react-native-quick-crypto#installation)
  for proper native dependency configuration. See the [react-expo
  example](https://github.com/evoluhq/evolu/tree/main/examples/react-expo) for
  required polyfills.
</ConditionalPlatformAlert>

## Define schema

First, define your app database schema—tables, columns, and types.

Evolu uses [Type](/docs/api-reference/common/Type) for data modeling. Instead of plain JS types like string or number, we recommend using branded types to enforce domain rules.

```ts
import * as Evolu from "@evolu/common";

// Primary keys are branded types, preventing accidental use of IDs across
// different tables (e.g., a TodoId can't be used where a UserId is expected).
const TodoId = Evolu.id("Todo");
type TodoId = typeof TodoId.Type;

// Schema defines database structure with runtime validation.
// Column types validate data on insert/update/upsert.
const Schema = {
  todo: {
    id: TodoId,
    // Branded type ensuring titles are non-empty and ≤100 chars.
    title: Evolu.NonEmptyString100,
    // SQLite doesn't support the boolean type; it uses 0 and 1 instead.
    isCompleted: Evolu.nullOr(Evolu.SqliteBoolean),
  },
};
```

<Note>
  Evolu automatically adds [system
  columns](/docs/api-reference/common/local-first/variables/SystemColumns-1):
  `createdAt`, `updatedAt`, `isDeleted`, and `ownerId`.
</Note>

## Create Evolu

After defining the schema, create an Evolu instance for your environment.

<SinglePlatformCodeGroup>

```ts {{ title: 'React', language: 'tsx' }}
import { createEvolu, SimpleName } from "@evolu/common";
import { createUseEvolu, EvoluProvider } from "@evolu/react";
import { evoluReactWebDeps } from "@evolu/react-web";

const evolu = createEvolu(evoluReactWebDeps)(Schema, {
  name: SimpleName.orThrow("your-app-name"),
  transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});

// Wrap your app with <EvoluProvider>
<EvoluProvider value={evolu}>
 {/* ... */}
</EvoluProvider>

// Create a typed React Hook returning an instance of Evolu
const useEvolu = createUseEvolu(evolu);

// Use the Hook in your app
const { insert, update } = useEvolu();
```

```ts {{ title: 'React Native', language: 'tsx' }}
import { createEvolu, SimpleName } from "@evolu/common";
import { createUseEvolu, EvoluProvider } from "@evolu/react";
import { evoluReactNativeDeps } from "@evolu/react-native/bare-op-sqlite";

const evolu = createEvolu(evoluReactNativeDeps)(Schema, {
 name: SimpleName.orThrow("your-app-name"),
 transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});

// Wrap your app with <EvoluProvider>
<EvoluProvider value={evolu}>
 {/* ... */}
</EvoluProvider>

// Create a typed React Hook returning an instance of Evolu
const useEvolu = createUseEvolu(evolu);

// Use the Hook in your app
const { insert, update } = useEvolu();
```

```ts {{ title: 'Expo', language: 'tsx' }}
import { createEvolu, SimpleName } from "@evolu/common";
import { createUseEvolu, EvoluProvider } from "@evolu/react";
import { evoluReactNativeDeps } from "@evolu/react-native/expo-sqlite";

const evolu = createEvolu(evoluReactNativeDeps)(Schema, {
 name: SimpleName.orThrow("your-app-name"),
 transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});

// Wrap your app with <EvoluProvider>
<EvoluProvider value={evolu}>
 {/* ... */}
</EvoluProvider>

// Create a typed React Hook returning an instance of Evolu
const useEvolu = createUseEvolu(evolu);

// Use the Hook in your app
const { insert, update } = useEvolu();
```

```ts {{ title: 'Svelte'}}
import * as Evolu from "@evolu/common";
import { evoluSvelteDeps } from "@evolu/svelte";

const evolu = Evolu.createEvolu(evoluSvelteDeps)(Schema, {
  name: Evolu.SimpleName.orThrow("your-app-name"),
  transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});
```

```ts {{ title: 'Vue', language: 'ts' }}
import { defineComponent } from "vue";
import { createEvolu, SimpleName } from "@evolu/common";
import { evoluWebDeps } from "@evolu/web";
import { provideEvolu } from "@evolu/vue";

const evolu = createEvolu(evoluWebDeps)(Schema, {
  name: SimpleName.orThrow("your-app-name"),
  transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});

export default defineComponent({
  setup() {
    provideEvolu(evolu);
    const { insert, update } = evolu;
    return { insert, update };
  },
});
```

```ts {{ title: 'Vanilla JS' }}
import { createEvolu, SimpleName } from "@evolu/common";
import { evoluWebDeps } from "@evolu/web";

const evolu = createEvolu(evoluWebDeps)(Schema, {
  name: SimpleName.orThrow("your-app-name"),
  transports: [{ type: "WebSocket", url: "wss://your-sync-url" }], // optional, defaults to free.evoluhq.com
});
```

</SinglePlatformCodeGroup>

## Mutate data

<SinglePlatformCodeGroup>

```ts {{ title: 'React', language: 'tsx' }}
const { insert, update } = useEvolu();

const result = insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

```ts {{ title: 'React Native', language: 'tsx' }}
const { insert, update } = useEvolu();

const result = insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

```ts {{ title: 'Expo', language: 'tsx' }}
const { insert, update } = useEvolu();

const result = insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

```ts {{ title: 'Svelte', language: 'ts' }}
const result = evolu.insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  evolu.update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

```ts {{ title: 'Vue', language: 'ts' }}
const { insert, update } = evolu;

const result = insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

```ts {{ title: 'Vanilla JS' }}
const result = evolu.insert("todo", {
  title: "New Todo",
  isCompleted: Evolu.sqliteFalse,
});

if (result.ok) {
  evolu.update("todo", { id: result.value.id, isCompleted: Evolu.sqliteTrue });
}
```

</SinglePlatformCodeGroup>

## Query data

Evolu uses type-safe TypeScript SQL query builder [Kysely](https://github.com/koskimas/kysely), so autocompletion works out-of-the-box.

Let's start with a simple `Query`.

```ts
const allTodos = evolu.createQuery((db) => db.selectFrom("todo").selectAll());
```

Once we have a query, we can load or subscribe to it.

<SinglePlatformCodeGroup>

```ts {{ title: 'React' }}
import { useQuery } from "@evolu/react";
// ...
const todos = useQuery(allTodos);
```

```ts {{ title: 'React Native' }}
import { useQuery } from "@evolu/react";
// ...
const todos = useQuery(allTodos);
```

```ts {{ title: 'Expo' }}
import { useQuery } from "@evolu/react";
// ...
const todos = useQuery(allTodos);
```

```ts {{ title: 'Svelte' }}
import { queryState } from "@evolu/svelte";

// Query once
const todosOnce = await evolu.loadQuery(allTodos);
// todosOnce.rows for all entries

// Subscribe to changes, automatically filled when the Data changes
const todos = queryState(evolu, () => allTodos);
// todos.rows for all entries
// Note this only works in .svelte or .svelte.js / .svelte.ts files due to the Svelte compiler
```

```ts {{ title: 'Vue' }}
import { useQuery } from "@evolu/vue";

const todos = useQuery(allTodos);
```

```ts {{ title: 'Vanilla JS' }}
// Query once
const todos = await evolu.loadQuery(allTodos);

const unsubscribe = evolu.subscribeQuery(allTodos)(() => {
  const rows = evolu.getQueryRows(allTodos);

  // do something with rows
});
```

</SinglePlatformCodeGroup>

## Delete data

To delete a row, set `isDeleted` to `sqliteTrue` (1). Evolu uses **soft deletes** instead of permanent deletion.

<SinglePlatformCodeGroup>

```ts {{ title: 'React', language: 'tsx' }}
const { update } = useEvolu();

// Mark a todo as deleted
update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

```ts {{ title: 'React Native', language: 'tsx' }}
const { update } = useEvolu();

// Mark a todo as deleted
update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

```ts {{ title: 'Expo', language: 'tsx' }}
const { update } = useEvolu();

// Mark a todo as deleted
update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

```ts {{ title: 'Svelte', language: 'ts' }}
// Mark a todo as deleted
evolu.update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

```ts {{ title: 'Vue', language: 'ts' }}
const { update } = evolu;

// Mark a todo as deleted
update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

```ts {{ title: 'Vanilla JS' }}
// Mark a todo as deleted
evolu.update("todo", { id: todoId, isDeleted: Evolu.sqliteTrue });
```

</SinglePlatformCodeGroup>

When querying, filter out deleted rows:

```ts
const activeTodos = evolu.createQuery((db) =>
  db
    .selectFrom("todo")
    .selectAll()
    // Filter out deleted rows
    .where("isDeleted", "is not", Evolu.sqliteTrue)
    .orderBy("createdAt"),
);
```

<Warn>
  Evolu does not permanently delete data—it marks them as deleted to support
  merging across devices and time travel. This is essential for local-first
  systems where devices sync asynchronously. See [Time
  Travel](/docs/time-travel) to learn how to recover deleted data.
</Warn>

## Protect data

**Privacy is essential for Evolu**, so all data are **encrypted** with an encryption key derived from a cryptographically strong secret (which can be represented as a [mnemonic](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)) or provided by an external hardware device.

<SinglePlatformCodeGroup>

```ts {{ title: 'React', language: 'tsx' }}
import { use } from "react";
// ...
const evolu = useEvolu();
const owner = use(evolu.appOwner);
console.log(owner.mnemonic);
// this will print the mnemonic in the console
```

```ts {{ title: 'React Native', language: 'tsx' }}
import { use } from "react";
// ...
const evolu = useEvolu();
const owner = use(evolu.appOwner);
console.log(owner.mnemonic);
// this will print the mnemonic in the console
```

```ts {{ title: 'Expo', language: 'tsx' }}
import { use } from "react";
// ...
const evolu = useEvolu();
const owner = use(evolu.appOwner);
console.log(owner.mnemonic);
// this will print the mnemonic in the console
```

```ts {{ title: 'Svelte' }}
import { appOwnerState } from "@evolu/svelte";

const owner = appOwnerState(evolu);
// use owner.current in your templates
```

```ts {{ title: 'Vue', language: 'ts' }}
import { useEvolu } from "@evolu/vue";

const evolu = useEvolu();
const owner = await evolu.appOwner;
console.log(owner.mnemonic);
```

```ts {{ title: 'Vanilla JS' }}
const owner = await evolu.appOwner;
console.log(owner.mnemonic);
```

</SinglePlatformCodeGroup>

## Purge data

To clear all local data from the device (this is different from soft deletes):

```ts
evolu.resetAppOwner();
```

<Note>
  This removes all data from the local database. This is not a soft delete—it's
  a complete reset.
</Note>

## Restore data

To restore synced data on any device:

```ts
evolu.restoreAppOwner(mnemonic);
```

To learn more about Evolu, explore our [playgrounds](/docs/playgrounds) and [examples](/docs/examples).
